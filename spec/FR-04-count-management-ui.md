# FR-04: 카운트 관리 웹 UI

## 1. Feature Description
- **Purpose**: 사용자가 웹 브라우저를 통해 카운트 데이터를 직접 관리(생성, 조회, 수동 변경)할 수 있는 인터페이스를 제공한다. [UR-09]
- **Scope**: 
    - 새로운 카운트 소스 등록 및 초기값 설정 기능.
        - 소스 식별자(Source ID) 제약: 소문자 영문, 숫자, 하이픈만 허용 (regex: `[a-z0-9-]+`)
    - 등록된 전체 카운트 목록 및 현재 값 실시간 조회.
    - 특정 카운트 값의 수동 증감(+1, -1) 및 상태 업데이트 기능.
    - HTMX를 활용한 비동기식 UI 업데이트로 매끄러운 사용자 경험 제공. [UR-10]
    - 오류 발생 시(중복 ID, 네트워크 오류 등) 페이지 새로고침 없는 상태 메시지 표시.
- **References**: 
    - **URD**: [UR-09] (웹 UI 기능), [UR-10] (HTMX 활용)
    - **PRD**: FR-04 (카운트 관리 웹 UI)
    - **Quality/Constraint**: QR-05 (UI 응답성), SC-05 (HTMX 기술 스택)

## 2. User Stories
- **FR-04-01**: 관리자로서 새로운 카운트 소스를 생성하고 싶다. 그래야 새로운 지표 측정을 시작할 수 있기 때문이다.
- **FR-04-02**: 관리자로서 현재 등록된 모든 카운트 목록을 확인하고 싶다. 그래야 시스템 전반의 상태를 모니터링할 수 있기 때문이다.
- **FR-04-03**: 관리자로서 카운트 값을 수동으로 증감시키고 싶다. 그래야 데이터 오류를 수정하거나 수동 운영 상황을 반영할 수 있기 때문이다.
- **FR-04-04**: 관리자로서 작업 실패 시 적절한 안내를 받고 싶다. 그래야 시스템 오류나 입력 실수를 인지하고 대응할 수 있기 때문이다.

## 3. Acceptance Criteria (Gherkin)

### FR-04-01 (카운트 생성)
- **FR-04-01-01**: 카운트 생성 폼 제출 (정상 케이스)
    - **Given**: 관리자가 카운트 생성 페이지에서 유효한 '소스 식별자(Source ID, `[a-z0-9-]+`)'와 '초기값'을 입력한다.
    - **When**: '생성' 버튼을 클릭한다.
    - **Then**: 서버에 생성 요청이 전송되고, 페이지 전체 새로고침 없이 HTMX를 통해 카운트 목록 하단에 새로운 항목이 즉시 추가된다.

- **FR-04-01-02**: 중복된 소스 식별자 처리
    - **Given**: 이미 존재하는 '소스 식별자'를 입력한다.
    - **When**: '생성' 버튼을 클릭한다.
    - **Then**: 페이지 전체 새로고침 없이, UI 상에 "이미 존재하는 ID입니다"와 같은 에러 메시지가 표시된다. (HTTP 409 Conflict 또는 400 Bad Request 응답 처리)

### FR-04-02 (카운트 목록 조회)
- **FR-04-02-01**: 목록 자동 로딩
    - **Given**: 관리자가 카운트 관리 메인 페이지에 접속한다.
    - **When**: 페이지가 렌더링된다.
    - **Then**: 현재 시스템에 저장된 모든 카운트의 소스 식별자와 현재 값이 테이블 형태로 표시된다.

### FR-04-03 (카운트 값 수동 변경)
- **FR-04-03-01**: 카운트 증가 (+1)
    - **Given**: 목록에서 특정 카운트 행의 '+' 버튼을 확인한다.
    - **When**: '+' 버튼을 클릭한다.
    - **Then**: 서버로 증가 요청이 전송되고, 해당 카운트의 값만 1 증가된 상태로 비동기(HTMX) 업데이트된다.

- **FR-04-03-02**: 카운트 감소 (-1)
    - **Given**: 목록에서 특정 카운트 행의 '-' 버튼을 확인한다.
    - **When**: '-' 버튼을 클릭한다.
    - **Then**: 서버로 감소 요청이 전송되고, 해당 카운트의 값만 1 감소된 상태로 비동기(HTMX) 업데이트된다. (단, 비즈니스 규칙에 따라 0 미만으로 내려가지 않아야 할 경우 0을 유지한다.)

### FR-04-04 (에러 처리)
- **FR-04-04-01**: HTMX 요청 실패 대응
    - **Given**: 네트워크 타임아웃 또는 서버 내부 오류(5xx)가 발생한 상황이다.
    - **When**: 사용자가 카운트 생성, 수정 등 HTMX 요청을 유발하는 버튼을 클릭한다.
    - **Then**: 페이지가 먹통이 되지 않고, HTMX의 `hx-on::error` 등을 활용하여 사용자에게 "요청을 처리할 수 없습니다. 다시 시도해주세요."와 같은 경고 메시지를 UI 상에 표시한다.
